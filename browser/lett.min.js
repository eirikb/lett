lett=function(){function r(e){return Object.keys(n).map(function(t){return{index:e.search(n[t]),name:t}}).filter(function(e){return e.index>=0}).sort(function(e,t){return e.index>t.index})[0]}function i(e){var t="",n=[],i=n,s,o;while(s=r(e)){if(s.index===0){var u=[];u.name=s.name,u.parent=i;if(s.name==="str"){s.index=e.indexOf(e.charAt(s.index),1);if(s.index<0)break;u.push(e.slice(1,s.index)),i.push(u)}else s.name==="end"?(i=i.parent,i.name==="fn"&&(i=i.parent)):(i.push(u),i=u);s.index++}else i.push(e.slice(0,s.index));i.name==="chain"&&!o?o=i:o&&s.name!=="chain"&&(i=o.parent,o=!1),e=e.slice(s.index).trim()}return i.push(e.trim()),n}function s(e){var t;for(t=0;t<e.length;t++)Array.isArray(e[t])&&(e[t]=s(e[t])),e[t].name==="call"&&t>0&&(e[t].call=e[t-1],e.splice(t-1,1));return e}function o(e,n){if(e.name){var r=a[e.name](e,n);return r}if(n[e])return n[e];if((""+e).match(/^true$/i))return!0;if((""+e).match(/^false$/))return!1;if(t[e])return t[e];var i=parseInt(e,10);return isNaN(i)?null:i}function u(e,t){function s(e){e=o(e,t),r.push(e),t[n]=e,n=null}if(e.length===1)return[o(e[0],t)];var n,r=[],i=0;return e.forEach(function(t,r){i%2===0?!t.name&&r<e.length-1?(n=t,i++):s(t):(s(t),i++)}),r}var e={};module={};var t={"+":function(){var e,t=parseInt(arguments[0],10);for(e=1;e<arguments.length;e++)t+=parseInt(arguments[e],10);return t},"-":function(){var e,t=parseInt(arguments[0],10);for(e=1;e<arguments.length;e++)t-=parseInt(arguments[e],10);return t},"/":function(){var e,t=parseInt(arguments[0],10);for(e=1;e<arguments.length;e++)t/=parseInt(arguments[e],10);return t},"*":function(){var e,t=parseInt(arguments[0],10);for(e=1;e<arguments.length;e++)t*=parseInt(arguments[e],10);return t},str:function(){var e,t="";for(e=0;e<arguments.length;e++)t+=arguments[e];return t},gt:function(e,t){return e=parseInt(e,10),t=parseInt(t,10),e>t},lt:function(e,t){return e=parseInt(e,10),t=parseInt(t,10),e<t},eq:function(e,t){return e===t},"if":function(e,t,n){return e?t:n},g:function(e,t){return e[t]}};Object.keys(t).forEach(function(n){e[n]=t[n]}),e.parse=function(e){e=e.replace(/\n|\r/g," ");var t=i(e).filter(function(e){return e});return t=s(t),t};var n={call:/\(/,divide:/ /,fnbody:/,/,fn:/</,obj:/\{/,array:/\[/,chain:/\./,str:/['"]/,end:/[\>\}\]\)]/};e.build=function(e,t){t||(t={});var n=u(e,t);return n[n.length-1]};var a={obj:function(e,t){var n={},r=u(e,n);return n},call:function(e,t){var n=t[e.call];n||(n=o(e.call,t));var r=e.map(function(e){return o(e,t)}),i=function(e){return r=r.map(function(t){return e&&e[t]&&(t=e[t]),t}),n.apply(null,r)};return i()},fn:function(e,t){var n=e.slice(0,-1),r=e[e.length-1];return function(){var e=arguments;return n.forEach(function(n,r){t[n]=e[r]}),r=o(r,t),r[r.length-1]}},str:function(e,t){return e[0]},array:function(e,t){return e.map(function(e){return o(e,t)})},chain:function(e,t){var n=e.parent[0],r=t[n];return typeof r=="function"&&(r=r()),e[1]?o(e[1],r):r[e[0]]},fnbody:function(e,t){return u(e,t)}};return module.exports=function(e,t){var n=parser.parse(e),r=builder.build(n,t);return r},parser=e,builder=e,module.exports}();