lett=function(){function r(e){return Object.keys(n).map(function(t){return{index:e.search(n[t]),name:t}}).filter(function(e){return e.index>=0}).sort(function(e,t){return e.index>t.index})[0]}function i(e){var t="",n=[],i=n,s;while(s=r(e)){if(s.index===0){var o=[];o.name=s.name,o.parent=i;if(s.name==="str"){s.index=e.indexOf(e.charAt(s.index),1);if(s.index<0)break;o.push(e.slice(1,s.index)),i.push(o)}else if(s.name==="end")i=i.parent,i.name==="fn"&&(i=i.parent);else if(s.name==="call"||s.name==="chain"){var u=i.length-1;o[s.name]=i[u],i=i[u]=o}else i.push(o),i=o;s.index++}else i.push(e.slice(0,s.index));e=e.slice(s.index).trim()}return i.push(e.trim()),n}function s(e,n){if(e.name){var r=u[e.name](e,n);return r}if(n[e])return n[e];if((""+e).match(/^true$/i))return!0;if((""+e).match(/^false$/i))return!1;if(t[e])return t[e];var i=parseInt(e,10);return isNaN(i)?null:i}function o(e,t){function o(e){e=s(e,t),r.push(e),t[n]=e,n=null}if(e.length===1)return[s(e[0],t)];var n,r=[],i=0;return e.forEach(function(t,r){i%2===0?!t.name&&r<e.length-1?(n=t,i++):o(t):(o(t),i++)}),r}var e={};module={};var t={"+":function(){var e,t=parseInt(arguments[0],10);for(e=1;e<arguments.length;e++)t+=parseInt(arguments[e],10);return t},"-":function(){var e,t=parseInt(arguments[0],10);for(e=1;e<arguments.length;e++)t-=parseInt(arguments[e],10);return t},"/":function(){var e,t=parseInt(arguments[0],10);for(e=1;e<arguments.length;e++)t/=parseInt(arguments[e],10);return t},"*":function(){var e,t=parseInt(arguments[0],10);for(e=1;e<arguments.length;e++)t*=parseInt(arguments[e],10);return t},str:function(){var e,t="";for(e=0;e<arguments.length;e++)t+=arguments[e];return t},gt:function(e,t){return e=parseInt(e,10),t=parseInt(t,10),e>t},lt:function(e,t){return e=parseInt(e,10),t=parseInt(t,10),e<t},eq:function(e,t){return e===t},"if":function(e,t,n){typeof e=="function"&&(e=e());var r=n;return e&&(r=t),typeof r=="function"?r():r},g:function(e,t){return e[t]}};Object.keys(t).forEach(function(n){e[n]=t[n]}),e.if.crap=!0,e.parse=function(e){e=e.replace(/\n|\r/g," ");var t=i(e).filter(function(e){return e});return t};var n={call:/\(/,divide:/ /,fnbody:/,/,fn:/</,obj:/\{/,array:/\[/,chain:/\./,str:/['"]/,end:/[\>\}\]\)]/};e.build=function(e,t){t||(t={});var n=o(e,t);return n[n.length-1]};var u={obj:function(e,t){var n={},r=o(e,n);return n},call:function(e,t){var n=t[e.call];n||(n=s(e.call,t));var r=function(r){var i=e.map(function(e){return s(e,t)});return i=i.map(function(e){return r&&r[e]&&(e=r[e]),e}),n.apply(null,i)};return n.crap&&(e.crap=!0),e.parent.crap?r:r()},fn:function(e,t){var n=e.slice(0,-1),r=e[e.length-1];return function(){var e=arguments;return n.forEach(function(n,r){t[n]=e[r]}),r=s(r,t),r[r.length-1]}},str:function(e,t){return e[0]},array:function(e,t){return e.map(function(e){return s(e,t)})},chain:function(e,t){var n=s(e.chain,t);return e[0]?s(e[0],n):n},fnbody:function(e,t){return o(e,t)}};return module.exports=function(e,t){var n=parser.parse(e),r=builder.build(n,t);return r},parser=e,builder=e,module.exports}();